====== BookingReceipt.java ======
public class BookingReceipt {
    public final String id;
    public final double fare;
    public BookingReceipt(String id, double fare) { this.id = id; this.fare = fare; }
}

====== ConsoleUi.java ======
// Smell: unused UI wrapper
public class ConsoleUi {
    public void print(String s) { System.out.println(s); }
}

====== DistanceCalculator.java ======
public class DistanceCalculator {
    public double km(GeoPoint a, GeoPoint b) {
        // fake distance: rough Manhattan on scaled degrees for determinism
        double d = Math.abs(a.lat - b.lat) + Math.abs(a.lon - b.lon);
        double km = Math.round((d * 200.0) * 10.0) / 10.0; // produces 6.0 for the demo points
        return km;
    }
}

====== DriverAllocator.java ======
public class DriverAllocator {
    public String allocate(String studentId) {
        // fake deterministic driver
        return "DRV-17";
    }
}

====== GeoPoint.java ======
public class GeoPoint {
    public final double lat;
    public final double lon;
    public GeoPoint(double lat, double lon) { this.lat = lat; this.lon = lon; }
}

====== Main.java ======
public class Main {
    public static void main(String[] args) {
        System.out.println("=== Transport Booking ===");
        TripRequest req = new TripRequest("23BCS1010", new GeoPoint(12.97, 77.59), new GeoPoint(12.93, 77.62));
        TransportBookingService svc = new TransportBookingService();
        svc.book(req);
    }
}

====== PaymentGateway.java ======
public class PaymentGateway {
    public String charge(String studentId, double amount) {
        // fake deterministic txn
        return "TXN-9001";
    }
}

====== TransportBookingService.java ======
public class TransportBookingService {
    // DIP violation: direct concretes
    public void book(TripRequest req) {
        DistanceCalculator dist = new DistanceCalculator();
        DriverAllocator alloc = new DriverAllocator();
        PaymentGateway pay = new PaymentGateway();

        double km = dist.km(req.from, req.to);
        System.out.println("DistanceKm=" + km);

        String driver = alloc.allocate(req.studentId);
        System.out.println("Driver=" + driver);

        double fare = 50.0 + km * 6.6666666667; // messy pricing
        fare = Math.round(fare * 100.0) / 100.0;

        String txn = pay.charge(req.studentId, fare);
        System.out.println("Payment=PAID txn=" + txn);

        BookingReceipt r = new BookingReceipt("R-501", fare);
        System.out.println("RECEIPT: " + r.id + " | fare=" + String.format("%.2f", r.fare));
    }
}

====== TripRequest.java ======
public class TripRequest {
    public final String studentId;
    public final GeoPoint from;
    public final GeoPoint to;

    public TripRequest(String studentId, GeoPoint from, GeoPoint to) {
        this.studentId = studentId; this.from = from; this.to = to;
    }
}

====== BookingReceipt.java ======
public class BookingReceipt {
    public final String id;
    public final double fare;
    public BookingReceipt(String id, double fare) { this.id = id; this.fare = fare; }
}

====== ConsoleUi.java ======
// Smell: unused UI wrapper
public class ConsoleUi {
    public void print(String s) { System.out.println(s); }
}

====== DistanceCalculator.java ======
public class DistanceCalculator {
    public double km(GeoPoint a, GeoPoint b) {
        // fake distance: rough Manhattan on scaled degrees for determinism
        double d = Math.abs(a.lat - b.lat) + Math.abs(a.lon - b.lon);
        double km = Math.round((d * 200.0) * 10.0) / 10.0; // produces 6.0 for the demo points
        return km;
    }
}

====== DriverAllocator.java ======
public class DriverAllocator {
    public String allocate(String studentId) {
        // fake deterministic driver
        return "DRV-17";
    }
}

====== GeoPoint.java ======
public class GeoPoint {
    public final double lat;
    public final double lon;
    public GeoPoint(double lat, double lon) { this.lat = lat; this.lon = lon; }
}

====== Main.java ======
public class Main {
    public static void main(String[] args) {
        System.out.println("=== Transport Booking ===");
        TripRequest req = new TripRequest("23BCS1010", new GeoPoint(12.97, 77.59), new GeoPoint(12.93, 77.62));
        TransportBookingService svc = new TransportBookingService();
        svc.book(req);
    }
}

====== PaymentGateway.java ======
public class PaymentGateway {
    public String charge(String studentId, double amount) {
        // fake deterministic txn
        return "TXN-9001";
    }
}

====== TransportBookingService.java ======
public class TransportBookingService {
    // DIP violation: direct concretes
    public void book(TripRequest req) {
        DistanceCalculator dist = new DistanceCalculator();
        DriverAllocator alloc = new DriverAllocator();
        PaymentGateway pay = new PaymentGateway();

        double km = dist.km(req.from, req.to);
        System.out.println("DistanceKm=" + km);

        String driver = alloc.allocate(req.studentId);
        System.out.println("Driver=" + driver);

        double fare = 50.0 + km * 6.6666666667; // messy pricing
        fare = Math.round(fare * 100.0) / 100.0;

        String txn = pay.charge(req.studentId, fare);
        System.out.println("Payment=PAID txn=" + txn);

        BookingReceipt r = new BookingReceipt("R-501", fare);
        System.out.println("RECEIPT: " + r.id + " | fare=" + String.format("%.2f", r.fare));
    }
}

====== TripRequest.java ======
public class TripRequest {
    public final String studentId;
    public final GeoPoint from;
    public final GeoPoint to;

    public TripRequest(String studentId, GeoPoint from, GeoPoint to) {
        this.studentId = studentId; this.from = from; this.to = to;
    }
}

